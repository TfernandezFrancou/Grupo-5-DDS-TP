<!DOCTYPE html>
<html data-bs-theme="light" lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>loginPage</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="./loginPage.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
</head>

<body>
    <section class="position-relative py-4 py-xl-5" id="loginPage">
        <div class="container">
            <div class="row mb-5">
                <div class="col-md-8 col-xl-6 text-center mx-auto">
                    <h2><strong>Iniciar sesión</strong></h2>
                </div>
            </div>
            <div class="row d-flex justify-content-center">
                <div class="col-md-6 col-xl-4">
                    <div class="card mb-5">
                        <div class="card-body d-flex flex-column align-items-center">
                            <div class="bs-icon-xl bs-icon-circle bs-icon-primary bs-icon my-4"><i class="fa fa-gear"></i></div>
                            <form class="text-center" method="post" @submit.prevent="submitLoginForm">
                                <div class="mb-3"><input v-model="formData.username" class="form-control form-control form-control" type="text" name="text" placeholder="Usuario"></div>
                                <div class="mb-3"><input v-model="formData.password" class="form-control form-control form-control" type="password" name="password" placeholder="Contraseña"></div>
                                <div class="mb-3"><button class="btn btn-primary d-block w-100" type="submit" @click="submitLoginForm">Iniciar sesión</button></div>
                                <p class="text-muted">Olvidaste tu contraseña?</p>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var app = new Vue({
                el: "#loginPage",
                data: {
                    formData: {
                        username: "",
                        password: ""
                    }
                },
                methods: {
                    submitLoginForm() {
                        // Crear un objeto con los datos del formulario
                        const loginData = {
                            username: this.formData.username,
                            password: this.formData.password
                        };

                        // Realizar la solicitud POST
                        fetch('http://localhost:4567/api/login', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(loginData)
                        })
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error('Error al iniciar sesión');
                                }
                                return response.json();
                            })
                            .then(data => {
                                console.log('Respuesta del servidor:', data);
                                localStorage.setItem('idSesion',data.idSesion);
                                window.location.href='./perfil.html'
                            })
                            .catch(error => {
                                console.error('Error:', error);
                            });
                    }
                }
            });
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>